--USE DB_BIBLIOTECA
--SELECT (SELECT 'FABIO') AS SUBCONSULTA
WITH CONSULTACTE (LIVRO,PRECO,AUTOR)
AS ( 
SELECT L.NOME_LIVRO AS LIVRO, L.PRECO_LIVRO AS PRECO, A.NOME_AUTOR AS AUTOR
FROM TBL_LIVRO AS L
INNER JOIN TBL_AUTORES AS A
ON L.ID_AUTOR = A.ID_AUTOR
)

 
SELECT LIVRO, SUM(PRECO) AS VALOPRECO
FROM CONSULTACTE
GROUP BY LIVRO
ORDER BY VALOPRECO